<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Home | Cookie.Joo Blog</title>
<meta name="generator" content="Jekyll v4.2.0">
<meta property="og:title" content="Home">
<meta name="author" content="GitHub User">
<meta property="og:locale" content="en_US">
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.">
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.">
<link rel="canonical" href="/">
<meta property="og:url" content="/">
<meta property="og:site_name" content="Cookie.Joo Blog">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Home">
<script type="application/ld+json">
{"headline":"Home","@type":"WebSite","author":{"@type":"Person","name":"GitHub User"},"description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","name":"Cookie.Joo Blog","url":"/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="favicon.ico">
  <link rel="stylesheet" href="/assets/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Cookie.Joo Blog">
<link rel="stylesheet" href="/assets/css/default.min.css">
<script src="/assets/js/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="/assets/js/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
<script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>



























































































































<header class="site-header site-header-transparent" role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="Cookie.Joo Blog" src="" onerror="this.style.display='none'">
  Cookie.Joo Blog
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/archives.html">ARCHIVES</a><a class="page-link" href="/categories.html">CATEGORIES</a><a class="page-link" href="/">HOME</a><a class="page-link" href="/tags.html">TAGS</a>




<span class="page-link">

<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://cdn.countryflags.com/thumbs/united-states-of-america/flag-400.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://cdn.countryflags.com/thumbs/france/flag-400.png" title="French">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://cdn.countryflags.com/thumbs/china/flag-400.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://cdn.countryflags.com/thumbs/japan/flag-400.png" title="Japanese">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://cdn.countryflags.com/thumbs/south-korea/flag-400.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://cdn.countryflags.com/thumbs/russia/flag-400.png" title="Russian">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: '',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="/assets/js/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;documentElement.setAttribute("data-header-transparent", "");var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  })();
</script>
















































































































































<section class="page-banner">
    <div class="page-banner-img">
<div style="background-image: url(/assets/images/banners/home.jpeg)"></div>
        <img class="img-placeholder" src="/assets/images/banners/home.jpeg">
</div>
    <div class="wrapper">
      <div class="page-banner-inner"><div class="page-banner-default">
            <h1 class="page-banner-heading">
              Welcome To My Nest
            </h1>
            <h2 class="page-banner-subheading">
              it's warm here
            </h2>
          </div></div>
    </div>
  </section><script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="articles">
  

  


  <div class="pagination">
  <!-- Post list links -->
  <ul class="post-list">
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/netty/2021/09/07/netty-reactor.html">
          netty-reactor
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Sep 07, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/netty/2021/09/07/netty-reactor.html">
        <p>
        什么是经典的三种I/O模式

我们在学Netty的时候讲的最多的就是Reactor的三种模式，因为他的这个模式用的最广泛，涉及的I/O知识点很基础也很常用。



  我们去吃饭的时候：


1：家乐园排队打饭，排队在窗口，打好才走。

2：点单，拿一个号码牌等待被叫，好了自己去端走。

3：辣可可包厢模式，点单后菜直接端上桌。


  类比：


饭店-&gt;服务器

饭菜-&gt;数据

饭菜好了-&gt;数据就绪

端菜、送菜-&gt;读取数据


  
    
      模式
      特点
      JDK版本
    
  
  
    
      排队打饭模式
      BIO（阻塞）
      JDK1.4之前
    
    
      点单被叫... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#netty">#netty</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/netty/2021/09/02/netty-http-server.html">
          netty-http-server
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Sep 02, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 11 mins</span>
      </div>
      <a class="post-excerpt" href="/netty/2021/09/02/netty-http-server.html">
        <p>
        场景

一个应用如果不是web应用，如何使用http接口上传文件下载文件？



寻找解决方案

我在某应用想开发一个http接口时，发现我的应用不是web应用，想用成熟的组件如spring-web、spring-boot、Tomcat等却望梅止渴，这时候netty就出场了，高性能网络传输框架。

我记得sentinel有类似的接口比如说下发规则到客户端，监听的是8720端口，我去翻了sentinel的源码，确实是用netty做为接口交互的。shardingsphere开源软件也用netty做http和前端交互，我也参考了源码。



建立服务

 
import com.alibaba.csp.sentinel.concurrent.NamedThreadFactory;
impor... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#netty">#netty</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/07/24/mockito-assert-verify.html">
          Mockito 断言和校验器《第九章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jul 24, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 9 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/07/24/mockito-assert-verify.html">
        <p>
        前言

我们有很多篇幅介绍了如果使用mock挡板等工具做无外部依赖单元测试，本章聊一下单元测试中的断言和校验器。

断言Assertj

推荐用Assertj 断言，反观Assert不是那么的直观好用。Assertj支持字符串、数字、日期、List、Map、Class等类型，此外还提供了好用的 fail 方法。除此之外，对Java中的Exception、Iterable、JodaTime、Guava等都提供支持。

    import static org.assertj.core.api.Assertions.*;

		@Test
    public void testList() {
        List&lt;String&gt; names = Lists.newAr... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/07/23/mockito-test-web.html">
          Mockito WEB接口测试《第八章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jul 23, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 4 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/07/23/mockito-test-web.html">
        <p>
        前言

前面基本都是接口后端类的测试，这章聊一下web端的http服务如何测试。

我们使用junit测试web的时候不得不起一个完整的服务后调用才能够进入controller代码里面，就如下代码：

@Controller
@RequestMapping
public class WarehouseController {
	@RequestMapping(value = "/web/warehouse/httpDownload")
    public ResponseEntity&lt;String&gt; httpDownload(
    	HttpServletRequest request,
       	HttpServletResponse response,
  ... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/07/18/mockito-normal-skill.html">
          Mockito 正常场景测试技巧《第六章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jul 18, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 8 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/07/18/mockito-normal-skill.html">
        <p>
        正常场景测试技巧

在这半个月我写的单元测试用例代码中，遇到了很多问题，比如私有变量、方法内部new对象、静态方法mock等，有些代码我们确实难以模拟的，我把我的解决方式跟大家分享一下。

各种service接口模拟

// Spring里面的接口、Dubbo接口等注入
public class TestServiceImpl{
	@Resource
	private MyService myService;
  
}

// 单元测试这么做
public class Test{
  @Mock
  MyService myService;
  @InjectMocks
  TestServiceImpl testService;

  @Before
  public void se... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/07/18/mockito-exception-skill.html">
          Mockito 异常场景测试技巧《第七章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jul 18, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 2 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/07/18/mockito-exception-skill.html">
        <p>
        异常场景测试技巧

我们的方法有时候没有异常返回，但是内部的某些方法我们try catch了需要测试覆盖到，这类的场景我们也是非常常见的且着重要注意到的。

模拟执行某方法异常测试

public class TestServiceImpl{
  @Resource
	private MyService myService;
  
	public boolean doSomeThing(){
    boolean isError = false;
    try{
      myService.getName();
    } catch(Exception e) {
      isError = true;
    }
    return isError;
  }
  
  ... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/07/03/mockito-test-rocketmq-producer.html">
          Mockito EventBus RocketMQ 生产者测试《第五章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jul 03, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 4 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/07/03/mockito-test-rocketmq-producer.html">
        <p>
        前言

上一章说到了RocketMQ在EvnetBus包装下的测试工具。本章主要讲MSF EventBus生产者操作。

EventBus 生产者模拟测试

请看下面实例：

import com.alibaba.fastjson.JSONObject;
import com.qihoo.finance.msf.event.bus.base.DelayTimeEnum;
import com.qihoo.finance.msf.event.bus.base.EventBus;
import com.qihoo.finance.msf.event.bus.base.MsfEventBusException;
import org.apache.rocketmq.client.except... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/07/02/mockito-test-rocketmq-consumer.html">
          Mockito EventBus RocketMQ 消费者测试《第四章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jul 02, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 3 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/07/02/mockito-test-rocketmq-consumer.html">
        <p>
        前言

在消息中间件中我们要模拟的是收发信息的动作，MQ这类的是依赖第三方消息中间件的，除去启动消息中间件去消费消息这一动作外，其实我们最关心的是我们接受到消息后怎么处理的问题，那么收消息是MQ中多线程去拉取数据的，也是官方jar提供工具类帮我们做的，所以我们需要入手的就是模拟有人给我们发消息，这个接收类是我们重点Mock的对象。本章主要讲如何在单元测试中模拟收RocketMQ服务器消息操作。

还是一如既往的不使用真正的服务器，直接用mock挡板。

EventBus 消费者模拟测试

MSF框架中提供了抽象类，用户只要继承该类去实现handle方法即可，请看下面实例：

首先需要建一个子类的实现类，并且实现父类的handle方法

import com.qihoo.finance.... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/07/01/mockito-test-mongo.html">
          Mockito MongoDB测试《第三章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jul 01, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 3 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/07/01/mockito-test-mongo.html">
        <p>
        1：前言

上一章说到了Redis测试工具，我们需要模拟的是Redis连接挡板。本章主要讲如何在单元测试中模拟Mongo服务器操作。

还是一如既往的不使用真正的服务器，直接用mock挡板。

2：Mongo模拟测试

请看下面实例：

import com.google.common.collect.Lists;
import com.mongodb.MongoClient;
import com.mongodb.client.ListDatabasesIterable;
import org.bson.Document;
import org.bson.types.ObjectId;
import org.junit.Before;
import org.junit.Test;
i... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/06/30/mockito-test-redis.html">
          Mockito Redis测试《第二章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jun 30, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 3 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/06/30/mockito-test-redis.html">
        <p>
        前言

上一章说到了Mockito测试工具，大概入门的使用了该工具模拟调用Dubbo接口。本章主要讲如何在单元测试中模拟Redis服务器操作。

还是一如既往的不使用真正的服务器，直接用mock挡板。

Redis模拟测试

请看下面实例：


import com.qihoo.finance.msf.cache.redis.RedisCache;
import org.junit.Before;
import org.junit.Test;
import org.springframework.data.redis.connection.RedisConnection;
import org.springframework.data.redis.connection.RedisCon... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/06/20/mockito-test-service.html">
          Mockito 接口测试《第一章》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jun 20, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 7 mins</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/06/20/mockito-test-service.html">
        <p>
        什么是Mock测试

Mock测试就是在测试过程中，对于某些不容易构造或者不容易获取的对象，用一个虚拟的对象来创建以便测试的测试方法。什么是不容易构造的对象呢？例如HttpServletRequest，需要在有servlet容器环境中创建获取。那不容易获取的对象呢？如一个JedisCluster，需要准备redis相关环境，然后设置进去等等。

Mock 可以分解在单元测试中耦合的其他类或者接口，它能够帮你模拟这些依赖，并帮你验证所调用的依赖的行为。

关于Mockito的简介之前有同事已经介绍过这里就不在赘述了，大家有兴趣可以自行去官方文档查阅，这里主要带大家了解一些常用的Mock方法。

&lt;dependency&gt;
    &lt;groupId&gt;org.mocki... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/unit/test/2021/06/19/mockito-test-standard.html">
          单元测试准则《开篇》
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jun 19, 2021</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/unit/test/2021/06/19/mockito-test-standard.html">
        <p>
        单元测试应该遵循的原则


  F-FAST(快速原则)
单元测试应该是可以快速运行的，在各种测试方法中，单元测试的运行速度是最快的，通常应该在几分钟内运行完毕
  I-Independent(独立原则)
单元测试应该是可以独立运行的，单元测试用例互相无强依赖，无对外部资源的强依赖
  
    R-Repeatable(可重复原则)
单元测试应该可以稳定重复的运行，并且每次运行的结果都是相同的
  
  
    S-Self Validating(自我验证原则)
单元测试应该是用例自动进行验证的，不能依赖人工验证
  
  T-Timely(及时原则）
单元测试必须及时的进行编写，更新和维护，以保证用例可以随着业务代码的变化动态的保障质量


MSF单元测规约


  测试是多而小... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#test">#test</a><a class="post-tag" href="/tags.html#mockito">#mockito</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/jekyll/2018/12/07/welcome-to-jekyll.html">
          Welcome to Jekyll!
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Dec 07, 2018</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/jekyll/2018/12/07/welcome-to-jekyll.html">
        <p>
        You’ll find this post in your _posts directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run jekyll serve, which launches a web server and auto-regenerates your site when a file is updated.

To add new posts, simply add a file in the _posts dire... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#jekyll">#jekyll</a><a class="post-tag" href="/tags.html#theme">#theme</a><a class="post-tag" href="/tags.html#yat">#yat</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/markdown/2018/12/05/an-exhibit-of-markdown.html">
          An exhibit of Markdown
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Dec 05, 2018</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 2 mins</span>
      </div>
      <a class="post-excerpt" href="/markdown/2018/12/05/an-exhibit-of-markdown.html">
        <p>
        This note demonstrates some of what Markdown is capable of doing.

An exhibit of Markdown

Note: Feel free to play with this page. Unlike regular notes, this doesn’t automatically save itself.

Basic formatting

Paragraphs can be written like so. A paragraph is the basic block of Markdown. A paragraph is what text will turn into when there is no... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags">
<a class="post-tag" href="/tags.html#example">#example</a><a class="post-tag" href="/tags.html#markdown">#markdown</a>
</div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/markdown/2018/05/26/mathjax-test.html">
          Mathjax Test
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> May 26, 2018</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/markdown/2018/05/26/mathjax-test.html">
        <p>
        
  A safe integer is an integer that
    
      can be exactly represented as an IEEE-754 double precision number, and
      whose IEEE-75 representation cannot be the result of rounding any other integer to fit the IEEE-754 representation
    
  
  For example, $ 2 ^ {53} - 1 $ is a safe integer,
    
      it can be exactly represented
    
  

 <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#test">#test</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/example/2017/12/18/video-example.html">
          Video example
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Dec 18, 2017</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 3 mins</span>
      </div>
      <a class="post-excerpt" href="/example/2017/12/18/video-example.html">
        <p>
        Canon in D (Pachelbel’s Canon) - Cello &amp; Piano [BEST WEDDING VERSION]
Some of you know that we occasionally play for weddings. As you can imagine, we get a LOT of requests for Canon in D, and we discovered that there were no good arrangements available anywhere for piano and cello! Hard to believe given its popularity. So we decided to make ... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#video">#video</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/example/2017/12/15/table-example.html">
          Table example
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Dec 15, 2017</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 4 mins</span>
      </div>
      <a class="post-excerpt" href="/example/2017/12/15/table-example.html">
        <p>
        Table example as below

For now, these extended features are provided:


  Cells spanning multiple columns
  Cells spanning multiple rows
  Cells text align separately
  Table header not required
  Grouped table header rows or data rows


Rowspan and Colspan
^^ in a cell indicates it should be merged with the cell above.
This feature is contribu... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#table">#table</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/example/2017/12/08/mermaid-example.html">
          Mermaid example
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Dec 08, 2017</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/example/2017/12/08/mermaid-example.html">
        <p>
        1. Pie chart



2. sequence diagram





3. Class diagram


4. State diagram

 <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#mermaid">#mermaid</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/example/2017/12/04/plantuml-example.html">
          Plantuml example
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Dec 04, 2017</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/example/2017/12/04/plantuml-example.html">
        <p>
        My First PlantUML

PlantUML Block-1


PlantUML Block-2


PlantUML Block-3


PlantUML Block-4


 <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#plantuml">#plantuml</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/markdown/2017/06/10/quick-mardown-example.html">
          Quick markdown example
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jun 10, 2017</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 3 mins</span>
      </div>
      <a class="post-excerpt" href="/markdown/2017/06/10/quick-mardown-example.html">
        <p>
        Paragraphs are separated by a blank line.

2nd paragraph. Italic, bold, and monospace. Itemized lists
look like:


  this one
  that one
  the other one


Note that — not considering the asterisk — the actual text
content starts at 4-columns in.


  Block quotes are
written like so.

  They can span multiple paragraphs,
if you like.


Use 3 dash... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#example">#example</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/junk/2017/05/20/this-post-demonstrates-post-content-styles.html">
          This post demonstrates post content styles
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> May 20, 2017</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 4 mins</span>
      </div>
      <a class="post-excerpt" href="/junk/2017/05/20/this-post-demonstrates-post-content-styles.html">
        <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce bibendum neque eget nunc mattis eu sollicitudin enim tincidunt. Vestibulum lacus tortor, ultricies id dignissim ac, bibendum in velit.

Some great heading (h2)

Proin convallis mi ac felis pharetra aliquam. Curabitur dignissim accumsan rutrum. In arcu magna, aliquet vel pretium et, m... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/junk/2016/08/12/my-example-post.html">
          My Example Post
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Aug 12, 2016</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/junk/2016/08/12/my-example-post.html">
        <p>
        Eos eu docendi tractatos sapientem, brute option menandri in vix, quando vivendo accommodare te ius. Nec melius fastidii constituam id, viderer theophrastus ad sit, hinc semper periculis cum id. Noluisse postulant assentior est in, no choro sadipscing repudiandae vix. Vis in euismod delenit dignissim. Ex quod nostrum sit, suas decore animal id i... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/misc/2016/05/20/super-long-article.html">
          Some articles are just so long they deserve a really long title to see if things will break well
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> May 20, 2016</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/misc/2016/05/20/super-long-article.html">
        <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce bibendum neque eget nunc mattis eu sollicitudin enim tincidunt. Vestibulum lacus tortor, ultricies id dignissim ac, bibendum in velit. Proin convallis mi ac felis pharetra aliquam. Curabitur dignissim accumsan rutrum. In arcu magna, aliquet vel pretium et, molestie et arcu. Mauris lo... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/misc/2016/05/19/super-short-article.html">
          Some articles are just so short that we have to make the footer stick
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> May 19, 2016</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/misc/2016/05/19/super-short-article.html">
        <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur s... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/markdown/2016/01/01/another-test-markdown.html">
          Another test markdown
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Jan 01, 2016</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 9 mins</span>
      </div>
      <a class="post-excerpt" href="/markdown/2016/01/01/another-test-markdown.html">
        <p>
        Put the math expression within $…$:

\(\LaTeX{}\)

$\Pi$

$ a * b = c ^ b $

$ 2^{\frac{n-1}{3}} $

$ \int_a^b f(x)\,dx. $

\( \int_a^b f(x)\,dx. \)


  
    
      $ \rho {\rm{FOD}} = \sum\limits{\sigma ,i} {(\delta _1 - \delta _2 n_i^\sigma )
      \phi _i^\sigma ({\bf{r}})
      ^2} $
    
  



  
    
      $$ \rho {\rm{FOD}} = \sum\limits{... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#test">#test</a></div>
    </li>
<li>
      





























































<h2 class="post-title">
        <a class="post-link" href="/markdown/2015/02/28/test-markdown.html">
          Test markdown
        </a>
      </h2>
      <div class="post-meta">
        <span class="post-date"><i class="fa fa-calendar"></i> Feb 28, 2015</span>
        <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 1 min</span>
      </div>
      <a class="post-excerpt" href="/markdown/2015/02/28/test-markdown.html">
        <p>
        You can write regular markdown here and Jekyll will automatically convert it to a nice webpage.  I strongly encourage you to take 5 minutes to learn how to write in markdown - it’ll teach you how to transform regular text into bold/italics/headings/tables/etc.

Here is some bold text

Here is a secondary heading

Here’s a useless table:


  
   ... <span class="read_more">Read More</span>
        </p>
      </a>
      <div class="post-tags"><a class="post-tag" href="/tags.html#test">#test</a></div>
    </li>
</ul>

  <!-- Pagination links -->
</div>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items -->




















<div class="common-list">
  <ul>
    <li>
      <a href="/index.html">
        All<span>26</span>
      </a>
    </li>

    
      <li>
        <a href="/categories.html#h-Netty">
          Netty <span>2</span>
        </a>
      </li>
    
      <li>
        <a href="/categories.html#h-Test">
          Test <span>10</span>
        </a>
      </li>
    
      <li>
        <a href="/categories.html#h-Unit">
          Unit <span>10</span>
        </a>
      </li>
    
      <li>
        <a href="/categories.html#h-example">
          example <span>4</span>
        </a>
      </li>
    
      <li>
        <a href="/categories.html#h-jekyll">
          jekyll <span>1</span>
        </a>
      </li>
    
      <li>
        <a href="/categories.html#h-junk">
          junk <span>2</span>
        </a>
      </li>
    
      <li>
        <a href="/categories.html#h-markdown">
          markdown <span>5</span>
        </a>
      </li>
    
      <li>
        <a href="/categories.html#h-misc">
          misc <span>2</span>
        </a>
      </li>
    
  </ul>
</div>

</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
      <div>Copyright © 1970-2010 @GitHub User</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="http://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
