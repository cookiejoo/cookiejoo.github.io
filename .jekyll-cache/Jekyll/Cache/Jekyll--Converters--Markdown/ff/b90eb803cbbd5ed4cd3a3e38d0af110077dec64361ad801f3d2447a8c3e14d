I"šb<h3 id="å‰è¨€">å‰è¨€</h3>

<p>æˆ‘ä»¬åœ¨å¸¸è§„æ€§ç³»ç»Ÿè§‚æµ‹é¢†åŸŸä¼šåšä¸€äº›ç³»ç»Ÿå±‚é¢çš„æœåŠ¡æŒ‡æ ‡æš‚æ—¶ä»ªè¡¨ç›˜ï¼Œä½†åŸºæœ¬ä¸Šå¯¹ç³»ç»Ÿçš„æŒ‡æ ‡æˆ–è®¸ã€è¿›ç¨‹çš„æŒ‡æ ‡è·å–ç”¨javaå…¶å®ä¹Ÿæœ‰ç‚¹éš¾åº¦çš„ï¼Œä»Šå¤©æˆ‘ä»¬å­¦ä¸€ä¸‹OSHIè¿™ä¸ªç±»åº“ï¼Œå®ƒæä¾›äº†å¾ˆå¤šæ–¹æ³•ç”¨äºè·å–ç³»ç»Ÿå’Œè¿›ç¨‹æ•°æ®ï¼Œå’±ä»¬æ¥åšä¸ªæ¼‚äº®çš„ä»ªè¡¨ç›˜ã€‚</p>

<h3 id="oshi">OSHI</h3>

<p>OSHIæ˜¯Javaçš„å…è´¹çš„åŸºäºJNAçš„ï¼ˆæœ¬æœºï¼‰æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ä¿¡æ¯åº“ã€‚å®ƒä¸éœ€è¦å®‰è£…ä»»ä½•å…¶ä»–æœ¬æœºåº“ï¼Œå¹¶ä¸”æ—¨åœ¨æä¾›ä¸€ç§è·¨å¹³å°çš„å®ç°æ¥æ£€ç´¢ç³»ç»Ÿä¿¡æ¯ï¼Œä¾‹å¦‚OSç‰ˆæœ¬ï¼Œè¿›ç¨‹ï¼Œå†…å­˜å’ŒCPUä½¿ç”¨ç‡ï¼Œç£ç›˜å’Œåˆ†åŒºï¼Œè®¾å¤‡ï¼Œä¼ æ„Ÿå™¨ç­‰ã€‚</p>

<p>æ”¯æŒå¹³å°:
Windows â€¢ Linux â€¢ macOS â€¢ Unix (AIX, FreeBSD, Solaris)</p>

<p>â€“ è®¡ç®—æœºç³»ç»Ÿå’Œå›ºä»¶ï¼Œåº•æ¿</p>

<p>â€“ æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬/å†…éƒ¨ç‰ˆæœ¬</p>

<p>â€“ ç‰©ç†ï¼ˆæ ¸å¿ƒï¼‰å’Œé€»è¾‘ï¼ˆè¶…çº¿ç¨‹ï¼‰CPUï¼Œå¤„ç†å™¨ç»„ï¼ŒNUMAèŠ‚ç‚¹</p>

<p>â€“ ç³»ç»Ÿå’Œæ¯ä¸ªå¤„ç†å™¨çš„è´Ÿè½½ï¼Œä½¿ç”¨æƒ…å†µæ»´ç­”è®¡æ•°å™¨ï¼Œä¸­æ–­ï¼Œæ­£å¸¸è¿è¡Œæ—¶é—´</p>

<p>â€“ è¿›ç¨‹æ­£å¸¸è¿è¡Œæ—¶é—´ï¼ŒCPUï¼Œå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œç”¨æˆ·/ç»„ï¼Œå‘½ä»¤è¡Œå‚æ•°ï¼Œçº¿ç¨‹è¯¦ç»†ä¿¡æ¯</p>

<p>â€“ å·²ä½¿ç”¨/å¯ç”¨çš„ç‰©ç†å’Œè™šæ‹Ÿå†…å­˜</p>

<p>â€“ æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆç±»å‹ï¼Œå¯ç”¨ç©ºé—´å’Œæ€»ç©ºé—´ï¼Œé€‰é¡¹ï¼Œè¯»å–å’Œå†™å…¥ï¼‰</p>

<p>â€“ ç£ç›˜é©±åŠ¨å™¨ï¼ˆå‹å·ï¼Œåºåˆ—å·ï¼Œå¤§å°ï¼Œè¯»å–å’Œå†™å…¥ï¼‰å’Œåˆ†åŒº</p>

<p>â€“ ç½‘ç»œæ¥å£ï¼ˆIPï¼Œå¸¦å®½è¾“å…¥/è¾“å‡ºï¼‰ï¼Œç½‘ç»œå‚æ•°ï¼ŒTCP / UDPç»Ÿè®¡ä¿¡æ¯</p>

<p>â€“ ç”µæ± çŠ¶æ€ï¼ˆç”µé‡ç™¾åˆ†æ¯”ï¼Œå‰©ä½™æ—¶é—´ï¼Œç”µé‡ä½¿ç”¨æƒ…å†µç»Ÿè®¡ä¿¡æ¯ï¼‰</p>

<p>â€“ USBè®¾å¤‡</p>

<p>â€“ è¿æ¥çš„æ˜¾ç¤ºå™¨ï¼ˆå¸¦æœ‰EDIDä¿¡æ¯ï¼‰ï¼Œå›¾å½¢å’Œå£°å¡</p>

<p>â€“ æŸäº›ç¡¬ä»¶ä¸Šçš„ä¼ æ„Ÿå™¨ï¼ˆæ¸©åº¦ï¼Œé£æ‰‡é€Ÿåº¦ï¼Œç”µå‹ï¼‰</p>

<p>æ‰€ä»¥ç»å¤§éƒ¨åˆ†å¹³å°éƒ½æ»¡è¶³éœ€æ±‚äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»–çš„ä¸€äº›è·å–ç³»ç»ŸæŒ‡æ ‡çš„æ–¹æ³•ï¼Œæœ‰å¾ˆå¤šæˆ‘ä¹Ÿæ²¡æ•´æ˜ç™½ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†çœ‹æ‡‚çš„å·²ç»å¤Ÿç”¨äº†ã€‚</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.github.oshi<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>oshi-core<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>6.2.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">oshi.SystemInfo</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oshi.hardware.CentralProcessor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oshi.hardware.CentralProcessor.TickType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oshi.hardware.GlobalMemory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oshi.hardware.HardwareAbstractionLayer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oshi.software.os.FileSystem</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oshi.software.os.OSFileStore</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oshi.software.os.OperatingSystem</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oshi.util.Util</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.UnknownHostException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>

<span class="cm">/**
 * @author cookie.joo
 * @date 2022-08-25
 */</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OshiTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">SystemInfo</span> <span class="n">si</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SystemInfo</span><span class="o">();</span>
        <span class="nc">HardwareAbstractionLayer</span> <span class="n">hal</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="na">getHardware</span><span class="o">();</span>
        <span class="n">setCpuInfo</span><span class="o">(</span><span class="n">hal</span><span class="o">.</span><span class="na">getProcessor</span><span class="o">());</span>
        <span class="n">setMemInfo</span><span class="o">(</span><span class="n">hal</span><span class="o">.</span><span class="na">getMemory</span><span class="o">());</span>
        <span class="n">setSysInfo</span><span class="o">();</span>
        <span class="n">setJvmInfo</span><span class="o">();</span>
        <span class="n">setSysFiles</span><span class="o">(</span><span class="n">si</span><span class="o">.</span><span class="na">getOperatingSystem</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="cm">/**
     * è®¾ç½®CPUä¿¡æ¯
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setCpuInfo</span><span class="o">(</span><span class="nc">CentralProcessor</span> <span class="n">processor</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// CPUä¿¡æ¯</span>
        <span class="kt">long</span><span class="o">[]</span> <span class="n">prevTicks</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="na">getSystemCpuLoadTicks</span><span class="o">();</span>
        <span class="nc">Util</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
        <span class="kt">long</span><span class="o">[]</span> <span class="n">ticks</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="na">getSystemCpuLoadTicks</span><span class="o">();</span>
        <span class="kt">long</span> <span class="n">nice</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">NICE</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()]</span> <span class="o">-</span> <span class="n">prevTicks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">NICE</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
        <span class="kt">long</span> <span class="n">irq</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">IRQ</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()]</span> <span class="o">-</span> <span class="n">prevTicks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">IRQ</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
        <span class="kt">long</span> <span class="n">softirq</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">SOFTIRQ</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()]</span> <span class="o">-</span> <span class="n">prevTicks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">SOFTIRQ</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
        <span class="kt">long</span> <span class="n">steal</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">STEAL</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()]</span> <span class="o">-</span> <span class="n">prevTicks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">STEAL</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
        <span class="kt">long</span> <span class="n">cSys</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">SYSTEM</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()]</span> <span class="o">-</span> <span class="n">prevTicks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">SYSTEM</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
        <span class="kt">long</span> <span class="n">user</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">USER</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()]</span> <span class="o">-</span> <span class="n">prevTicks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">USER</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
        <span class="kt">long</span> <span class="n">iowait</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">IOWAIT</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()]</span> <span class="o">-</span> <span class="n">prevTicks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">IOWAIT</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
        <span class="kt">long</span> <span class="n">idle</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">IDLE</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()]</span> <span class="o">-</span> <span class="n">prevTicks</span><span class="o">[</span><span class="nc">TickType</span><span class="o">.</span><span class="na">IDLE</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
        <span class="kt">long</span> <span class="n">totalCpu</span> <span class="o">=</span> <span class="n">user</span> <span class="o">+</span> <span class="n">nice</span> <span class="o">+</span> <span class="n">cSys</span> <span class="o">+</span> <span class="n">idle</span> <span class="o">+</span> <span class="n">iowait</span> <span class="o">+</span> <span class="n">irq</span> <span class="o">+</span> <span class="n">softirq</span> <span class="o">+</span> <span class="n">steal</span><span class="o">;</span>
        <span class="c1">// æ ¸å¿ƒæ•° processor.getLogicalProcessorCount()</span>
        <span class="c1">// CPUæ€»çš„ä½¿ç”¨ç‡ totalCpu</span>
        <span class="c1">// CPUç³»ç»Ÿä½¿ç”¨ç‡ cSys</span>
        <span class="c1">// CPUç”¨æˆ·ä½¿ç”¨ç‡ user</span>
        <span class="c1">// CPUå½“å‰ç­‰å¾…ç‡ iowait</span>
        <span class="c1">// CPUå½“å‰ç©ºé—²ç‡ idle</span>
    <span class="o">}</span>

    <span class="cm">/**
     * è®¾ç½®å†…å­˜ä¿¡æ¯
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setMemInfo</span><span class="o">(</span><span class="nc">GlobalMemory</span> <span class="n">memory</span><span class="o">)</span> <span class="o">{</span>
         <span class="c1">// å†…å­˜æ€»é‡ memory.getTotal()</span>
         <span class="c1">// å·²ç”¨å†…å­˜ memory.getTotal() - memory.getAvailable()</span>
         <span class="c1">// å‰©ä½™å†…å­˜ memory.getAvailable()</span>
    <span class="o">}</span>

    <span class="cm">/**
     * è®¾ç½®æœåŠ¡å™¨ä¿¡æ¯
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setSysInfo</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">getProperties</span><span class="o">();</span>
        <span class="c1">// æ“ä½œç³»ç»Ÿ sys.setOsName(props.getProperty("os.name"));</span>
        <span class="c1">// ç³»ç»Ÿæ¶æ„ sys.setOsArch(props.getProperty("os.arch"));</span>
        <span class="c1">// é¡¹ç›®è·¯å¾„ sys.setUserDir(props.getProperty("user.dir"));</span>
    <span class="o">}</span>

    <span class="cm">/**
     * è®¾ç½®Javaè™šæ‹Ÿæœº
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setJvmInfo</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">UnknownHostException</span> <span class="o">{</span>
        <span class="nc">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">getProperties</span><span class="o">();</span>
        <span class="c1">// å†…å­˜æ€»é‡ Runtime.getRuntime().totalMemory()</span>
        <span class="c1">// å½“å‰å†…å­˜ä½¿ç”¨ç‡ Runtime.getRuntime().maxMemory()</span>
        <span class="c1">// å†…å­˜ç©ºé—²ç‡ Runtime.getRuntime().freeMemory()</span>
        <span class="c1">// JDKç‰ˆæœ¬ props.getProperty("java.version")</span>
        <span class="c1">// JDKå®‰è£…è·¯å¾„ props.getProperty("java.home")</span>
    <span class="o">}</span>

    <span class="cm">/**
     * è®¾ç½®ç£ç›˜ä¿¡æ¯
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setSysFiles</span><span class="o">(</span><span class="nc">OperatingSystem</span> <span class="n">os</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">FileSystem</span> <span class="n">fileSystem</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="na">getFileSystem</span><span class="o">();</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OSFileStore</span><span class="o">&gt;</span> <span class="n">fsArray</span> <span class="o">=</span> <span class="n">fileSystem</span><span class="o">.</span><span class="na">getFileStores</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">OSFileStore</span> <span class="n">fs</span> <span class="o">:</span> <span class="n">fsArray</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">long</span> <span class="n">free</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="na">getUsableSpace</span><span class="o">();</span>
            <span class="kt">long</span> <span class="n">total</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="na">getTotalSpace</span><span class="o">();</span>
            <span class="kt">long</span> <span class="n">used</span> <span class="o">=</span> <span class="n">total</span> <span class="o">-</span> <span class="n">free</span><span class="o">;</span>
            <span class="c1">// ç›˜ç¬¦è·¯å¾„ fs.getMount()</span>
            <span class="c1">// ç›˜ç¬¦ç±»å‹ fs.getType()</span>
            <span class="c1">// æ–‡ä»¶ç±»å‹ fs.getName());</span>
            <span class="c1">// æ€»å¤§å° convertFileSize(total)</span>
            <span class="c1">// å‰©ä½™å¤§å° convertFileSize(free)</span>
            <span class="c1">// å·²ç»ä½¿ç”¨é‡ sysFile.setUsed(convertFileSize(used)</span>
            <span class="c1">// èµ„æºçš„ä½¿ç”¨ç‡ Arith.mul(Arith.div(used, total, 4), 100)</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * å­—èŠ‚è½¬æ¢
     *
     * @param size å­—èŠ‚å¤§å°
     * @return è½¬æ¢åå€¼
     */</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">convertFileSize</span><span class="o">(</span><span class="kt">long</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">kb</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">;</span>
        <span class="kt">long</span> <span class="n">mb</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">;</span>
        <span class="kt">long</span> <span class="n">gb</span> <span class="o">=</span> <span class="n">mb</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">gb</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%.1f GB"</span><span class="o">,</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">size</span> <span class="o">/</span> <span class="n">gb</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">mb</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">size</span> <span class="o">/</span> <span class="n">mb</span><span class="o">;</span>
            <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">f</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="o">?</span> <span class="s">"%.0f MB"</span> <span class="o">:</span> <span class="s">"%.1f MB"</span><span class="o">,</span> <span class="n">f</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">kb</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">size</span> <span class="o">/</span> <span class="n">kb</span><span class="o">;</span>
            <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">f</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="o">?</span> <span class="s">"%.0f KB"</span> <span class="o">:</span> <span class="s">"%.1f KB"</span><span class="o">,</span> <span class="n">f</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%d B"</span><span class="o">,</span> <span class="n">size</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<h3 id="ä»ªè¡¨ç›˜">ä»ªè¡¨ç›˜</h3>

<p><img src="/images/2022-08-25-oshi/image-20220825182025514.png" alt="image-20220825182025514" /></p>

<p>æˆ‘ä»¬å€Ÿç”¨å¼€æºçš„ä¸€ä¸ªç•Œé¢æ¥åšå‚è€ƒï¼Œå«WARDçš„ä¸€ä¸ªGitHubé¡¹ç›®ï¼Œæœ‰å…´è¶£å¯ä»¥å»çœ‹çœ‹ï¼Œå…¶å®å°±æ˜¯ç”¨çš„OSHIï¼Œå‰ç«¯ç”¨çš„jså’Œcssç”Ÿæˆçš„åŠ¨æ€èƒŒæ™¯å›¾å¾ˆé…·ç‚«æ¼‚äº®ï¼Œæˆ‘æŠŠä»–é›†æˆåˆ°æˆ‘çš„ä¸ªäººwebé¡¹ç›®é‡Œé¢å¶å°”å¯ä»¥æ‰“å¼€çœ‹çœ‹æœºå™¨è´Ÿè½½æƒ…å†µã€‚</p>

<p>å»ºç«‹ä¸€ä¸ªControllerç±»å‰ç«¯æ¯ä¸ªä¸€ç§’é’Ÿæ¥è·å–ä¸€ä¸‹ç³»ç»ŸæŒ‡æ ‡æ•°æ®å³å¯ã€‚é‡ç‚¹è¦è¯´ä¸€ä¸‹è¿™ä¸ªUtil.sleep(1000)ä¸ºä»€ä¹ˆè¦ä¼‘çœ ä¸€ä¼šï¼Œç„¶åç”¨å½“å‰æ—¶é—´å€¼å‡å»ä¸Šä¸€ä¸ªæ—¶é—´å€¼ï¼Œæˆ‘CentralProcessor.getSystemCpuLoadTicksæ–¹æ³•æ³¨é‡Šä¸Šçœ‹åˆ°äº†è¯´æ˜ï¼Œæ„æ€æ˜¯<strong>é€šè¿‡æµ‹é‡è·¨æ—¶é—´é—´éš”çš„èŠ‚æ‹ä¹‹é—´çš„å·®å¼‚ï¼Œå¯ä»¥è®¡ç®—è¯¥æ—¶é—´é—´éš”ä¸Šçš„CPUè´Ÿè½½</strong>ã€‚å®ƒç›®çš„æ˜¯è®¡ç®—å½“å‰ç›´æ¥çš„ä½¿ç”¨ç‡ï¼Œè¿™ä¸ªå€¼æ˜¯ä¸åœçš„é€’å¢çš„ï¼Œæ‰€ä»¥å¿…é¡»ç”¨è¿™ä¸ªæ–¹å¼æ¥å¾—åˆ°è¿™ä¸ªå€¼ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kt">int</span> <span class="nf">getProcessor</span><span class="o">(){</span>
  <span class="nc">CentralProcessor</span> <span class="n">centralProcessor</span> <span class="o">=</span> <span class="n">systemInfo</span><span class="o">.</span><span class="na">getHardware</span><span class="o">().</span><span class="na">getProcessor</span><span class="o">();</span>
  <span class="c1">// ç¬¬ä¸€æ¬¡è·å–ï¼šè·å–ç³»ç»ŸèŒƒå›´çš„ CPU è´Ÿè½½æ»´ç­”è®¡æ•°å™¨ï¼š</span>
  <span class="kt">long</span><span class="o">[]</span> <span class="n">prevTicksArray</span> <span class="o">=</span> <span class="n">centralProcessor</span><span class="o">.</span><span class="na">getSystemCpuLoadTicks</span><span class="o">();</span>
  <span class="kt">long</span> <span class="n">prevTotalTicks</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">prevTicksArray</span><span class="o">).</span><span class="na">sum</span><span class="o">();</span>
  <span class="kt">long</span> <span class="n">prevIdleTicks</span> <span class="o">=</span> <span class="n">prevTicksArray</span><span class="o">[</span><span class="nc">CentralProcessor</span><span class="o">.</span><span class="na">TickType</span><span class="o">.</span><span class="na">IDLE</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>
  <span class="c1">//ç­‰å¾…ä¸€æ®µæ—¶é—´</span>
  <span class="nc">Util</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>

  <span class="c1">//ç¬¬äºŒæ¬¡è·å–ï¼šè·å–ç³»ç»ŸèŒƒå›´çš„ CPU è´Ÿè½½æ»´ç­”è®¡æ•°å™¨ï¼š</span>
  <span class="kt">long</span><span class="o">[]</span> <span class="n">currTicksArray</span> <span class="o">=</span> <span class="n">centralProcessor</span><span class="o">.</span><span class="na">getSystemCpuLoadTicks</span><span class="o">();</span>
  <span class="kt">long</span> <span class="n">currTotalTicks</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">currTicksArray</span><span class="o">).</span><span class="na">sum</span><span class="o">();</span>
  <span class="kt">long</span> <span class="n">currIdleTicks</span> <span class="o">=</span> <span class="n">currTicksArray</span><span class="o">[</span><span class="nc">CentralProcessor</span><span class="o">.</span><span class="na">TickType</span><span class="o">.</span><span class="na">IDLE</span><span class="o">.</span><span class="na">getIndex</span><span class="o">()];</span>

  <span class="k">return</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="nc">Math</span><span class="o">.</span><span class="na">round</span><span class="o">((</span><span class="mi">1</span> <span class="o">-</span> <span class="o">((</span><span class="kt">double</span><span class="o">)</span> <span class="o">(</span><span class="n">currIdleTicks</span> <span class="o">-</span> <span class="n">prevIdleTicks</span><span class="o">))</span> <span class="o">/</span> <span class="o">((</span><span class="kt">double</span><span class="o">)</span> <span class="o">(</span><span class="n">currTotalTicks</span> <span class="o">-</span> <span class="n">prevTotalTicks</span><span class="o">)))</span> <span class="o">*</span> <span class="mi">100</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="æœ€å">æœ€å</h3>

<p>OSHIçš„å·¥å…·ç±»è®©æˆ‘ä»¬åœ¨Javaä¸­è·å–ç³»ç»Ÿå‚æ•°æŒ‡æ ‡æä¾›äº†éå†ï¼ŒWARDé¡¹ç›®è®©æˆ‘ä»¬åœ¨å¼€å‘webåº”ç”¨çš„æ—¶å€™å¤šäº†ä¸€ä¸ªèµå¿ƒæ‚¦ç›®çš„ä»ªè¡¨ç›˜ï¼Œè®©æˆ‘ä»¬éå‰ç«¯å¼€å‘äººå‘˜ä¹Ÿèƒ½åšå‡ºä¸€ä¸ªæ¼‚äº®çš„å‰ç«¯å±•ç¤ºæ¥ï¼Œè¿™ä¸ªå‰ç«¯åœ¨æ‰‹æœºç«¯æµè§ˆä¹Ÿæ˜¯é€‚é…çš„ã€‚</p>

<p>å¯ä»¥ç‚¹å‡»æˆ‘çš„<a href="http://caodegao.com:8080/">æœåŠ¡é“¾æ¥</a>çœ‹è¿™ä¸ªå‰ç«¯æ˜¾ç¤ºæ•ˆæœã€‚</p>

<p>OSHIæ›´å¤šå‚æ•°è¯·åˆ°å®˜ç½‘ä¸­æ¢ç´¢å§ï¼</p>

:ET